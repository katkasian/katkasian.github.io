<!DOCTYPE html>
<html lang="en">

<head>
            <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="">

        <title>Kateryna Kasianenko's Portfolio</title>

            <link href="https://katkasian.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Kateryna Kasianenko's Portfolio Full Atom Feed" />
            <link href="https://katkasian.github.io/feeds/python.atom.xml" type="application/atom+xml" rel="alternate" title="Kateryna Kasianenko's Portfolio Categories Atom Feed" />

        <!-- Bootstrap Core CSS -->
        <link href="https://katkasian.github.io/theme/css/bootstrap.min.css" rel="stylesheet">

        <!-- Custom CSS -->
        <link href="https://katkasian.github.io/theme/css/clean-blog.min.css" rel="stylesheet">

        <!-- Code highlight color scheme -->
            <link href="https://katkasian.github.io/theme/css/code_blocks/darkly.css" rel="stylesheet">

        <!-- Custom Fonts -->
        <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->






			<meta property="og:locale" content="en">
		<meta property="og:site_name" content="Kateryna Kasianenko's Portfolio">

	<meta property="og:type" content="article">
	<meta property="article:author" content="">
	<meta property="og:url" content="https://katkasian.github.io/gluten-free-app.html">
	<meta property="og:title" content="Gauging the Effect of Product Naming: a Gluten-Free Analysis of an Online Grocery App Dataset">
	<meta property="og:description" content="">
	<meta property="og:image" content="https://katkasian.github.io/siteImages/wheat.jpg">
	<meta property="article:published_time" content="2018-07-01 00:00:00+10:00">
</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="https://katkasian.github.io/">Kateryna Kasianenko's Portfolio</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">

                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Header -->
        <header class="intro-header" style="background-image: url('siteImages/wheat.jpg')">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>Gauging the Effect of Product Naming: a Gluten-Free Analysis of an Online Grocery App Dataset</h1>
                        <span class="meta">Posted by
                                <a href="https://katkasian.github.io/author/kateryna-kasianenko.html">Kateryna Kasianenko</a>
                             on Sun 01 July 2018
                        </span>
                        
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
    <!-- Post Content -->
    <article>
        <p>Does naming of a product influence its popularity? In this exercise, I use a dataset provided to <a href="https://www.kaggle.com/c/instacart-market-basket-analysis">Kaggle</a> by Instacart (a grocery ordering and delivery app) in order to try and answer the question about whether including the information about the product being "gluten-free" affects the number of customers who buy it. The analysis is performed in pandas library, and the main statistics explored is Jaccard similarity coefficient.</p>
<h1><strong>Questions to answer</strong></h1>
<h5>1. For two similar products, will the inclusing of "gluten-free" status in the name of one of the products influence its popularity?</h5>
<h5>2. Are these results going to be different for different types of products and time of purchase?</h5>
<div class="highlight"><pre><span></span><span class="c1">#importing necessary libraries and the dataset</span>
<span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s2">&quot;/content/drive&quot;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>Go to this URL in a browser: https://accounts.google.com/o/oauth2/auth?client_id=947318989803-6bn6qk8qdgf4n4g3pfee6491hc0brc4i.apps.googleusercontent.com&amp;redirect_uri=urn%3aietf%3awg%3aoauth%3a2.0%3aoob&amp;response_type=code&amp;scope=email%20https%3a%2f%2fwww.googleapis.com%2fauth%2fdocs.test%20https%3a%2f%2fwww.googleapis.com%2fauth%2fdrive%20https%3a%2f%2fwww.googleapis.com%2fauth%2fdrive.photos.readonly%20https%3a%2f%2fwww.googleapis.com%2fauth%2fpeopleapi.readonly

Enter your authorization code:
··········
Mounted at /content/drive
</pre></div>


<div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;drive/My Drive/datasets/order_new_foranalysis.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="o">/</span><span class="nt">usr</span><span class="o">/</span><span class="nt">local</span><span class="o">/</span><span class="nt">lib</span><span class="o">/</span><span class="nt">python3</span><span class="p">.</span><span class="nc">6</span><span class="o">/</span><span class="nt">dist-packages</span><span class="o">/</span><span class="nt">numpy</span><span class="o">/</span><span class="nt">lib</span><span class="o">/</span><span class="nt">arraysetops</span><span class="p">.</span><span class="nc">py</span><span class="p">:</span><span class="nd">569</span><span class="o">:</span> <span class="nt">FutureWarning</span><span class="o">:</span> <span class="nt">elementwise</span> <span class="nt">comparison</span> <span class="nt">failed</span><span class="o">;</span> <span class="nt">returning</span> <span class="nt">scalar</span> <span class="nt">instead</span><span class="o">,</span> <span class="nt">but</span> <span class="nt">in</span> <span class="nt">the</span> <span class="nt">future</span> <span class="nt">will</span> <span class="nt">perform</span> <span class="nt">elementwise</span> <span class="nt">comparison</span>
  <span class="nt">mask</span> <span class="o">|=</span> <span class="o">(</span><span class="nt">ar1</span> <span class="o">==</span> <span class="nt">a</span><span class="o">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#checking the data</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_id</th>
      <th>user_id</th>
      <th>eval_set</th>
      <th>order_number</th>
      <th>order_dow</th>
      <th>order_hour_of_day</th>
      <th>days_since_prior_order</th>
      <th>product_id</th>
      <th>add_to_cart_order</th>
      <th>reordered</th>
      <th>product_name</th>
      <th>aisle_id</th>
      <th>department_id</th>
      <th>aisle</th>
      <th>department</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1187899</td>
      <td>1</td>
      <td>train</td>
      <td>11</td>
      <td>4</td>
      <td>8</td>
      <td>14.0</td>
      <td>196</td>
      <td>1</td>
      <td>1</td>
      <td>Soda</td>
      <td>77</td>
      <td>7</td>
      <td>soft drinks</td>
      <td>beverages</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1187899</td>
      <td>1</td>
      <td>train</td>
      <td>11</td>
      <td>4</td>
      <td>8</td>
      <td>14.0</td>
      <td>25133</td>
      <td>2</td>
      <td>1</td>
      <td>Organic String Cheese</td>
      <td>21</td>
      <td>16</td>
      <td>packaged cheese</td>
      <td>dairy eggs</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1187899</td>
      <td>1</td>
      <td>train</td>
      <td>11</td>
      <td>4</td>
      <td>8</td>
      <td>14.0</td>
      <td>38928</td>
      <td>3</td>
      <td>1</td>
      <td>0% Greek Strained Yogurt</td>
      <td>120</td>
      <td>16</td>
      <td>yogurt</td>
      <td>dairy eggs</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1187899</td>
      <td>1</td>
      <td>train</td>
      <td>11</td>
      <td>4</td>
      <td>8</td>
      <td>14.0</td>
      <td>26405</td>
      <td>4</td>
      <td>1</td>
      <td>XL Pick-A-Size Paper Towel Rolls</td>
      <td>54</td>
      <td>17</td>
      <td>paper goods</td>
      <td>household</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1187899</td>
      <td>1</td>
      <td>train</td>
      <td>11</td>
      <td>4</td>
      <td>8</td>
      <td>14.0</td>
      <td>39657</td>
      <td>5</td>
      <td>1</td>
      <td>Milk Chocolate Almonds</td>
      <td>45</td>
      <td>19</td>
      <td>candy chocolate</td>
      <td>snacks</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><span class="c1">#simple cleaning of the name column</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;product_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">product_name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;product_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">product_name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[^\w\s]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_id</th>
      <th>user_id</th>
      <th>eval_set</th>
      <th>order_number</th>
      <th>order_dow</th>
      <th>order_hour_of_day</th>
      <th>days_since_prior_order</th>
      <th>product_id</th>
      <th>add_to_cart_order</th>
      <th>reordered</th>
      <th>product_name</th>
      <th>aisle_id</th>
      <th>department_id</th>
      <th>aisle</th>
      <th>department</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1187899</td>
      <td>1</td>
      <td>train</td>
      <td>11</td>
      <td>4</td>
      <td>8</td>
      <td>14.0</td>
      <td>196</td>
      <td>1</td>
      <td>1</td>
      <td>soda</td>
      <td>77</td>
      <td>7</td>
      <td>soft drinks</td>
      <td>beverages</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1187899</td>
      <td>1</td>
      <td>train</td>
      <td>11</td>
      <td>4</td>
      <td>8</td>
      <td>14.0</td>
      <td>25133</td>
      <td>2</td>
      <td>1</td>
      <td>organic string cheese</td>
      <td>21</td>
      <td>16</td>
      <td>packaged cheese</td>
      <td>dairy eggs</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1187899</td>
      <td>1</td>
      <td>train</td>
      <td>11</td>
      <td>4</td>
      <td>8</td>
      <td>14.0</td>
      <td>38928</td>
      <td>3</td>
      <td>1</td>
      <td>0 greek strained yogurt</td>
      <td>120</td>
      <td>16</td>
      <td>yogurt</td>
      <td>dairy eggs</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1187899</td>
      <td>1</td>
      <td>train</td>
      <td>11</td>
      <td>4</td>
      <td>8</td>
      <td>14.0</td>
      <td>26405</td>
      <td>4</td>
      <td>1</td>
      <td>xl pickasize paper towel rolls</td>
      <td>54</td>
      <td>17</td>
      <td>paper goods</td>
      <td>household</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1187899</td>
      <td>1</td>
      <td>train</td>
      <td>11</td>
      <td>4</td>
      <td>8</td>
      <td>14.0</td>
      <td>39657</td>
      <td>5</td>
      <td>1</td>
      <td>milk chocolate almonds</td>
      <td>45</td>
      <td>19</td>
      <td>candy chocolate</td>
      <td>snacks</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">jaccard_sim</span><span class="p">(</span><span class="n">str1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A function to check Jaccard similarity coefficient</span>
<span class="sd">    (intersection divided by union of sets) of an item name</span>
<span class="sd">    and a list of other names, returns a tuple - a match with highest score and a score&quot;&quot;&quot;</span>
    <span class="n">set1</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">str1</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
    <span class="n">maxn</span> <span class="o">=</span> <span class="n">products</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">set2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">maxn</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
    <span class="n">intersec</span> <span class="o">=</span> <span class="n">set1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">set2</span><span class="p">)</span>
    <span class="n">maxv</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">intersec</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">set1</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">set2</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">intersec</span><span class="p">)))</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">products</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="n">set2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="n">intersec</span> <span class="o">=</span> <span class="n">set1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">set2</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">intersec</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">set1</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">set2</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">intersec</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">&gt;</span> <span class="n">maxv</span><span class="p">:</span>
            <span class="n">maxv</span> <span class="o">=</span> <span class="n">result</span>
            <span class="n">maxn</span> <span class="o">=</span> <span class="n">name</span>
    <span class="n">to_return</span> <span class="o">=</span> <span class="p">(</span><span class="n">maxn</span><span class="p">,</span> <span class="n">maxv</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">to_return</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">gf</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;product_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;gluten&quot;</span><span class="p">)]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">gf</span><span class="o">.</span><span class="n">department</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
<span class="c1">#reducing departments to 5 with the highest number of orders</span>
<span class="n">gf</span> <span class="o">=</span> <span class="n">gf</span><span class="p">[</span><span class="n">gf</span><span class="p">[</span><span class="s2">&quot;department&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;snacks|frozen|bakery|breakfast|dry goods pasta&quot;</span><span class="p">)]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;department&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;snacks|frozen|bakery|breakfast|dry goods pasta&quot;</span><span class="p">)]</span>
</pre></div>


<div class="highlight"><pre><span></span>frozen             5029
snacks             4967
bakery             2505
breakfast          2189
dry goods pasta    1744
pantry              768
international       511
deli                476
babies              266
dairy eggs          142
canned goods         98
personal care        40
missing              39
other                14
meat seafood         12
Name: department, dtype: int64
</pre></div>


<div class="highlight"><pre><span></span><span class="n">products</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">product_name</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">gluten</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="o">.</span><span class="n">product_name</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">products</span><span class="p">)]</span>
<span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">gf</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">gluten</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">gf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">gluten</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span>(335895, 15)
(16434, 15)
(319461, 15)





True
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#checking if there are no gluten-free products missed in &quot;gluten&quot;</span>
<span class="n">gluten</span><span class="p">[</span><span class="n">gluten</span><span class="o">.</span><span class="n">product_name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;gluten&quot;</span><span class="p">)]</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_id</th>
      <th>user_id</th>
      <th>eval_set</th>
      <th>order_number</th>
      <th>order_dow</th>
      <th>order_hour_of_day</th>
      <th>days_since_prior_order</th>
      <th>product_id</th>
      <th>add_to_cart_order</th>
      <th>reordered</th>
      <th>product_name</th>
      <th>aisle_id</th>
      <th>department_id</th>
      <th>aisle</th>
      <th>department</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><span class="c1">#counting the highest jaccard similarity for non-gluten-free items to see if there are items with names similar to ones</span>
<span class="c1">#gluten-free</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">chained_assignment</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">gluten</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s2">&quot;paired&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gluten</span><span class="p">[</span><span class="s2">&quot;product_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">jaccard_sim</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#adding columns for most similar product and the similarity scor</span>
<span class="n">gluten</span><span class="p">[</span><span class="s2">&quot;paired_item&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gluten</span><span class="p">[</span><span class="s2">&quot;paired&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">gluten</span><span class="p">[</span><span class="s2">&quot;paired_score&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gluten</span><span class="p">[</span><span class="s2">&quot;paired&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">gluten</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;paired&quot;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">gluten</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_id</th>
      <th>user_id</th>
      <th>eval_set</th>
      <th>order_number</th>
      <th>order_dow</th>
      <th>order_hour_of_day</th>
      <th>days_since_prior_order</th>
      <th>product_id</th>
      <th>add_to_cart_order</th>
      <th>reordered</th>
      <th>product_name</th>
      <th>aisle_id</th>
      <th>department_id</th>
      <th>aisle</th>
      <th>department</th>
      <th>paired_item</th>
      <th>paired_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>1187899</td>
      <td>1</td>
      <td>train</td>
      <td>11</td>
      <td>4</td>
      <td>8</td>
      <td>14.0</td>
      <td>39657</td>
      <td>5</td>
      <td>1</td>
      <td>milk chocolate almonds</td>
      <td>45</td>
      <td>19</td>
      <td>candy chocolate</td>
      <td>snacks</td>
      <td>gluten free chocolate brownies</td>
      <td>0.166667</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1187899</td>
      <td>1</td>
      <td>train</td>
      <td>11</td>
      <td>4</td>
      <td>8</td>
      <td>14.0</td>
      <td>10258</td>
      <td>6</td>
      <td>1</td>
      <td>pistachios</td>
      <td>117</td>
      <td>19</td>
      <td>nuts seeds dried fruit</td>
      <td>snacks</td>
      <td>gluten free whole grain bread</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1187899</td>
      <td>1</td>
      <td>train</td>
      <td>11</td>
      <td>4</td>
      <td>8</td>
      <td>14.0</td>
      <td>13032</td>
      <td>7</td>
      <td>1</td>
      <td>cinnamon toast crunch</td>
      <td>121</td>
      <td>14</td>
      <td>cereal</td>
      <td>breakfast</td>
      <td>gluten free cinnamon french toast sticks</td>
      <td>0.285714</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1187899</td>
      <td>1</td>
      <td>train</td>
      <td>11</td>
      <td>4</td>
      <td>8</td>
      <td>14.0</td>
      <td>26088</td>
      <td>8</td>
      <td>1</td>
      <td>aged white cheddar popcorn</td>
      <td>23</td>
      <td>19</td>
      <td>popcorn jerky</td>
      <td>snacks</td>
      <td>aged white cheddar glutenfree baked rice and c...</td>
      <td>0.300000</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1492625</td>
      <td>2</td>
      <td>train</td>
      <td>15</td>
      <td>1</td>
      <td>11</td>
      <td>30.0</td>
      <td>16589</td>
      <td>3</td>
      <td>1</td>
      <td>plantain chips</td>
      <td>107</td>
      <td>19</td>
      <td>chips pretzels</td>
      <td>snacks</td>
      <td>glutenfree original falafel chips</td>
      <td>0.200000</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><span class="c1">#filtering out items with the score less than 0.5 </span>
<span class="n">analog</span> <span class="o">=</span> <span class="n">gluten</span><span class="p">[</span><span class="n">gluten</span><span class="o">.</span><span class="n">paired_score</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="n">analog</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_id</th>
      <th>user_id</th>
      <th>eval_set</th>
      <th>order_number</th>
      <th>order_dow</th>
      <th>order_hour_of_day</th>
      <th>days_since_prior_order</th>
      <th>product_id</th>
      <th>add_to_cart_order</th>
      <th>reordered</th>
      <th>product_name</th>
      <th>aisle_id</th>
      <th>department_id</th>
      <th>aisle</th>
      <th>department</th>
      <th>paired_item</th>
      <th>paired_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1382961</th>
      <td>2633656</td>
      <td>205981</td>
      <td>train</td>
      <td>7</td>
      <td>0</td>
      <td>16</td>
      <td>30.0</td>
      <td>42193</td>
      <td>10</td>
      <td>0</td>
      <td>chocolate chip cookie</td>
      <td>61</td>
      <td>19</td>
      <td>cookies cakes</td>
      <td>snacks</td>
      <td>chocolate chip cookie gluten free</td>
      <td>0.600000</td>
    </tr>
    <tr>
      <th>1383093</th>
      <td>1220791</td>
      <td>205997</td>
      <td>train</td>
      <td>8</td>
      <td>1</td>
      <td>18</td>
      <td>8.0</td>
      <td>25043</td>
      <td>10</td>
      <td>0</td>
      <td>instant oatmeal variety pack</td>
      <td>130</td>
      <td>14</td>
      <td>hot cereal pancake mixes</td>
      <td>breakfast</td>
      <td>variety pack of gluten free instant oatmeal</td>
      <td>0.571429</td>
    </tr>
    <tr>
      <th>1383109</th>
      <td>3319420</td>
      <td>206005</td>
      <td>train</td>
      <td>24</td>
      <td>0</td>
      <td>12</td>
      <td>10.0</td>
      <td>25246</td>
      <td>7</td>
      <td>0</td>
      <td>white cheddar macaroni  cheese cups</td>
      <td>4</td>
      <td>9</td>
      <td>instant foods</td>
      <td>dry goods pasta</td>
      <td>organic glutenfree white cheddar macaroni  cheese</td>
      <td>0.571429</td>
    </tr>
    <tr>
      <th>1383434</th>
      <td>2926243</td>
      <td>206051</td>
      <td>train</td>
      <td>38</td>
      <td>3</td>
      <td>16</td>
      <td>6.0</td>
      <td>14553</td>
      <td>5</td>
      <td>0</td>
      <td>oats  honey granola</td>
      <td>57</td>
      <td>14</td>
      <td>granola</td>
      <td>breakfast</td>
      <td>oats  honey gluten free granola</td>
      <td>0.600000</td>
    </tr>
    <tr>
      <th>1383824</th>
      <td>2682845</td>
      <td>206108</td>
      <td>train</td>
      <td>14</td>
      <td>0</td>
      <td>18</td>
      <td>27.0</td>
      <td>35004</td>
      <td>29</td>
      <td>1</td>
      <td>macaroni shells  white cheddar cheese</td>
      <td>4</td>
      <td>9</td>
      <td>instant foods</td>
      <td>dry goods pasta</td>
      <td>organic glutenfree white cheddar macaroni  cheese</td>
      <td>0.571429</td>
    </tr>
    <tr>
      <th>1383830</th>
      <td>2682845</td>
      <td>206108</td>
      <td>train</td>
      <td>14</td>
      <td>0</td>
      <td>18</td>
      <td>27.0</td>
      <td>40199</td>
      <td>35</td>
      <td>1</td>
      <td>chocolate chip cookies</td>
      <td>61</td>
      <td>19</td>
      <td>cookies cakes</td>
      <td>snacks</td>
      <td>gluten free chocolate chip cookies</td>
      <td>0.600000</td>
    </tr>
    <tr>
      <th>1384036</th>
      <td>1695230</td>
      <td>206128</td>
      <td>train</td>
      <td>16</td>
      <td>2</td>
      <td>8</td>
      <td>30.0</td>
      <td>45866</td>
      <td>2</td>
      <td>1</td>
      <td>fig newmans fruit filled cookies</td>
      <td>61</td>
      <td>19</td>
      <td>cookies cakes</td>
      <td>snacks</td>
      <td>gluten free fig fruit filled cookies</td>
      <td>0.571429</td>
    </tr>
    <tr>
      <th>1384194</th>
      <td>2721635</td>
      <td>206149</td>
      <td>train</td>
      <td>6</td>
      <td>6</td>
      <td>10</td>
      <td>30.0</td>
      <td>45866</td>
      <td>9</td>
      <td>0</td>
      <td>fig newmans fruit filled cookies</td>
      <td>61</td>
      <td>19</td>
      <td>cookies cakes</td>
      <td>snacks</td>
      <td>gluten free fig fruit filled cookies</td>
      <td>0.571429</td>
    </tr>
    <tr>
      <th>1384289</th>
      <td>2262542</td>
      <td>206157</td>
      <td>train</td>
      <td>11</td>
      <td>3</td>
      <td>13</td>
      <td>30.0</td>
      <td>25346</td>
      <td>15</td>
      <td>0</td>
      <td>peanut butter dark chocolate  protein bar</td>
      <td>3</td>
      <td>19</td>
      <td>energy granola bars</td>
      <td>snacks</td>
      <td>gluten free peanut butter cup dark chocolate p...</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>1384395</th>
      <td>1533014</td>
      <td>206176</td>
      <td>train</td>
      <td>15</td>
      <td>6</td>
      <td>16</td>
      <td>12.0</td>
      <td>258</td>
      <td>5</td>
      <td>0</td>
      <td>vegetable pot pie</td>
      <td>38</td>
      <td>1</td>
      <td>frozen meals</td>
      <td>frozen</td>
      <td>gluten free vegetable pot pie</td>
      <td>0.600000</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><span class="n">gfwithanalogs</span> <span class="o">=</span> <span class="n">analog</span><span class="o">.</span><span class="n">paired_item</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">analogs</span> <span class="o">=</span> <span class="n">analog</span><span class="o">.</span><span class="n">product_name</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;GF:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">gfwithanalogs</span><span class="p">),</span> <span class="s2">&quot;Non-GF:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">analogs</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">GF</span><span class="o">:</span> <span class="mi">99</span> <span class="n">Non</span><span class="o">-</span><span class="n">GF</span><span class="o">:</span> <span class="mi">169</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">gf</span> <span class="o">=</span> <span class="n">gf</span><span class="p">[</span><span class="n">gf</span><span class="p">[</span><span class="s2">&quot;product_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">gfwithanalogs</span><span class="p">)]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">analog</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">gf</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>(11320, 17)
(5013, 15)
</pre></div>


<div class="highlight"><pre><span></span><span class="n">gf_per_product</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="n">gf</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;product_name&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()})</span>
<span class="n">gf_per_product</span> <span class="o">=</span> <span class="n">gf_per_product</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span> <span class="bp">False</span><span class="p">)</span>

<span class="n">analog_per_product</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="n">analog</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;product_name&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()})</span>
<span class="n">analog_per_product</span> <span class="o">=</span> <span class="n">analog_per_product</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">gf_per_dept</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;n&quot;</span><span class="p">:</span><span class="n">gf</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;department&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()})</span>
<span class="n">gf_per_dept</span> <span class="o">=</span> <span class="n">gf_per_dept</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>

<span class="n">analog_per_dept</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="n">analog</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;department&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()})</span>
<span class="n">analog_per_dept</span> <span class="o">=</span> <span class="n">analog_per_dept</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#number of GF items and their analogs per department</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Gluten-free&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">gf_per_dept</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Non-gluten analogs </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">analog_per_dept</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>


<div class="highlight"><pre><span></span>Gluten-free
                    n
department           
snacks           2044
frozen           1455
bakery           1105
breakfast         358
dry goods pasta    51



Non-gluten analogs

                    n
department           
snacks           3229
frozen           2651
breakfast        2187
dry goods pasta  2050
bakery           1203
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#number of items per aisle</span>
<span class="n">gf_per_aisle</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;n&quot;</span><span class="p">:</span><span class="n">gf</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;aisle&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()})</span>
<span class="n">gf_per_aisle</span> <span class="o">=</span> <span class="n">gf_per_aisle</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>

<span class="n">analog_per_aisle</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;n&quot;</span><span class="p">:</span><span class="n">analog</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;aisle&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()})</span>
<span class="n">analog_per_aisle</span> <span class="o">=</span> <span class="n">analog_per_aisle</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Gluten-free&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">gf_per_aisle</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Non-gluten analogs&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">analog_per_aisle</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span>Gluten-free
                            n
aisle                        
chips pretzels            841
bread                     724
energy granola bars       669
frozen breads doughs      555
cookies cakes             481
frozen meat seafood       321
frozen meals              282
hot cereal pancake mixes  279
breakfast bakery          277
frozen appetizers sides   111
buns rolls                 97
ice cream ice              86
cereal                     63
frozen breakfast           51
crackers                   40
dry pasta                  35
frozen pizza               26
frozen dessert             23
granola                    16
ice cream toppings         13



Non-gluten analogs
                             n
aisle                         
hot cereal pancake mixes  1788
frozen meals              1449
cookies cakes             1184
pasta sauce                991
chips pretzels             895
bread                      889
popcorn jerky              753
frozen appetizers sides    579
instant foods              578
dry pasta                  388
breakfast bakery           290
energy granola bars        280
granola                    222
cereal                     177
ice cream ice              161
frozen pizza               157
frozen meat seafood        155
frozen vegan vegetarian     98
fresh pasta                 73
candy chocolate             60
</pre></div>


<div class="highlight"><pre><span></span><span class="n">merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">gf_per_aisle</span><span class="p">,</span> <span class="n">analog_per_aisle</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;gluten-free&quot;</span><span class="p">,</span> <span class="s2">&quot;analog&quot;</span><span class="p">]</span>
<span class="n">merged</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">cols</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#plotting the results</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="kn">as</span> <span class="nn">mpatches</span>

<span class="n">pos</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">merged</span><span class="o">.</span><span class="n">index</span><span class="p">)))</span>
<span class="n">width</span> <span class="o">=</span> <span class="mf">0.3</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">freebar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">merged</span><span class="p">[</span><span class="s2">&quot;gluten-free&quot;</span><span class="p">],</span>
        <span class="n">width</span><span class="p">,</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;slateblue&quot;</span><span class="p">)</span>
<span class="n">glutenbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">([</span><span class="n">p</span> <span class="o">+</span> <span class="n">width</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">],</span>
         <span class="n">merged</span><span class="p">[</span><span class="s2">&quot;analog&quot;</span><span class="p">],</span>
         <span class="n">width</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
         <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;lightsteelblue&quot;</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="n">p</span><span class="o">+</span><span class="mf">1.5</span> <span class="o">*</span> <span class="n">width</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">merged</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">rotation</span> <span class="o">=</span> <span class="mi">45</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Gluten-free and non-gluten-free analogs orders by aisle&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span>

<span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
    <span class="n">spine</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;silver&quot;</span><span class="p">)</span>

<span class="n">gluten</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;lightsteelblue&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Non-gluten-free&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">gluten_free</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;slateblue&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Gluten-free&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span> <span class="o">=</span> <span class="p">[</span><span class="n">gluten</span><span class="p">,</span> <span class="n">gluten_free</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>


<p><img alt="png" src="glutenfree_files/glutenfree_25_0.png"></p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">hours</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;order_hour_of_day&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">index</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;order_hour_of_day&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">hours</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;slateblue&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;GF items by order hour&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ghours</span> <span class="o">=</span> <span class="n">analog</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;order_hour_of_day&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">index</span>
<span class="n">gvalues</span> <span class="o">=</span> <span class="n">analog</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;order_hour_of_day&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ghours</span><span class="p">,</span> <span class="n">gvalues</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;lightsteelblue&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Non-GF analogs by order hour&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<p><img alt="png" src="glutenfree_files/glutenfree_26_0.png"></p>
<h1><strong>Conclusion</strong></h1>
<blockquote>
<p>① Instacart users tend to prefer non-gluten free items even if there is a gluten-free analog. </p>
<p>② This tendency is particularly stroing for items other than "healthy food" such as cakes, instant food, pancakes.</p>
<p>③ The time of purchase for gluten-free items and non-gluten free analogs was similar.</p>
</blockquote>
    </article>

    <hr>

            </div>
        </div>
    </div>

    <hr>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <ul class="list-inline text-center">
                        <li>
                            <a href="">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    </ul>
                    <p class="copyright text-muted">Blog powered by <a href="http://getpelican.com">Pelican</a>,
                which takes great advantage of <a href="http://python.org">Python</a>.</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- jQuery -->
    <script src="https://katkasian.github.io/theme/js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="https://katkasian.github.io/theme/js/bootstrap.min.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="https://katkasian.github.io/theme/js/clean-blog.min.js"></script>

</body>

</html>